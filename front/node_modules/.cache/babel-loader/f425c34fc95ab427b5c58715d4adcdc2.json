{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Fd-Formation\\\\Desktop\\\\Groupomania\\\\front\\\\src\\\\components\\\\Comments\\\\Comments.js\";\nimport React from \"react\";\nimport axios from \"axios\"; // Import component\n\nimport App from \"../App\";\nimport Comment from \"./Comment\";\nimport Avatar from \"../Avatar/Avatar\"; // Import style\n\nimport \"./Comments.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default class Comments extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      // DATAS\n      userLogged: props.userLogged,\n      articleId: props.articleId,\n      comments: props.comments,\n      valueComment: '',\n      fileUpload: null,\n      // OPTIONS\n      isClicked: false,\n      isValid: true,\n      isLoading: false\n    }; // Request Url\n\n    this.commentUrl = 'http://localhost:8080/api/comments'; // OnClick\n\n    this.OnSubmitComment = this.OnSubmitComment.bind(this);\n    this.OnChange = this.OnChange.bind(this);\n    this.onDeleteClick = this.onDeleteClick.bind(this);\n    this.onOptionsClick = this.onOptionsClick.bind(this);\n  } // Gestion de l'envoi.\n\n\n  OnSubmitComment(event) {\n    const {\n      userLogged,\n      articleId,\n      valueComment,\n      fileUpload\n    } = this.state; // Object contain value forms\n\n    const formData = new FormData();\n    formData.append(\"userId\", userLogged.id);\n    formData.append(\"comment\", valueComment);\n    formData.append(\"image\", fileUpload);\n    formData.append(\"articleId\", articleId);\n    event.preventDefault(); // Post request.\n\n    axios.post(this.commentUrl, formData, {\n      headers: {\n        Authorization: \"Bearer \" + sessionStorage.getItem(\"token\")\n      }\n    }).then(() => {\n      App.ReloadApp();\n    }).catch(error => {\n      console.error('Error Add Comment!');\n      console.warn(error);\n    });\n  } // Gestion des events.\n\n\n  OnChange(event) {\n    const myState = event.target.name;\n\n    switch (myState) {\n      case 'comment':\n        if (event.target.value.length) {\n          event.target.className = \"valid\";\n          this.setState({\n            isValid: false\n          });\n        } else {\n          event.target.className = \"\";\n          this.setState({\n            isValid: true\n          });\n        }\n\n        this.setState({\n          valueComment: event.target.value\n        });\n        break;\n\n      case 'image':\n        this.setState({\n          fileUpload: event.target.files[0]\n        });\n        break;\n\n      default:\n        console.error('Nothing here!');\n        break;\n    }\n  } // Suppression d'un commentaire.\n\n\n  async onDeleteClick(event) {\n    const commentId = event.target.value;\n\n    if (window.confirm('Êtes vous sûre ?')) {\n      // Delete request.\n      await axios.delete(this.commentUrl + '/' + commentId, {\n        headers: {\n          Authorization: \"Bearer \" + sessionStorage.getItem(\"token\")\n        }\n      }).then(() => App.ReloadApp());\n    }\n  } // Afficher/Cacher les options.\n\n\n  onOptionsClick() {\n    const {\n      isClicked\n    } = this.state;\n\n    switch (isClicked) {\n      // Hide Options.\n      default:\n      case true:\n        this.setState({\n          isClicked: false\n        });\n        break;\n      // Show Options.\n\n      case false:\n        this.setState({\n          isClicked: true\n        });\n        break;\n    }\n  } // Convertisseur de date.\n\n\n  convertDate(myDate) {\n    const start = new Date(myDate).getTime();\n    const current = Date.now();\n    const result = new Date(current - start);\n    let since = new Date(result);\n    if (since.getFullYear() <= 1970) {\n      if (since.getMonth() + 1 <= 1) {\n        if (since.getDate() <= 1) {\n          if (since.getHours() <= 1) {\n            if (since.getMinutes() < 1) since = new Date(result).getSeconds() + 'sec.';else since = since.getMinutes() + 'min.';\n          } else since = since.getHours() + 'h.';\n        } else since = since.getDate() + 'j.';\n      } else since = since.getMonth() + 1 + 'm.';\n    } else since = since.getFullYear() + 'y.';\n    return `${since}`;\n  }\n\n  render() {\n    const {\n      userLogged,\n      comments\n    } = this.state;\n    const {\n      isValid,\n      valueComment\n    } = this.state;\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [comments ? comments.map((comment, i) => /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: /*#__PURE__*/_jsxDEV(Comment, {\n          userLogged: userLogged,\n          comment: comment,\n          onDeleteClick: this.onDeleteClick\n        }, 'comment-' + comment.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 17\n        }, this)\n      }, void 0, false)) : /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false), /*#__PURE__*/_jsxDEV(\"form\", {\n        className: \"addComment\",\n        onSubmit: this.OnSubmitComment,\n        disabled: isValid,\n        children: [/*#__PURE__*/_jsxDEV(Avatar, {\n          dataUser: { ...userLogged,\n            isProfile: false\n          }\n        }, 'avatar-' + userLogged.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"comment\",\n          children: \"comment\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          id: \"comment\",\n          type: \"text\",\n          name: \"comment\",\n          placeholder: \"Ecrivez un commentaire...\",\n          value: valueComment,\n          onChange: this.OnChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          \"aria-label\": \"sendComment\",\n          disabled: isValid,\n          children: /*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"fa-solid fa-paper-plane\",\n            alt: \"sendComment\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 145,\n            columnNumber: 21\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"hidden\",\n          name: \"userId\",\n          value: userLogged.id\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true);\n  }\n\n}","map":{"version":3,"names":["React","axios","App","Comment","Avatar","Comments","Component","constructor","props","state","userLogged","articleId","comments","valueComment","fileUpload","isClicked","isValid","isLoading","commentUrl","OnSubmitComment","bind","OnChange","onDeleteClick","onOptionsClick","event","formData","FormData","append","id","preventDefault","post","headers","Authorization","sessionStorage","getItem","then","ReloadApp","catch","error","console","warn","myState","target","name","value","length","className","setState","files","commentId","window","confirm","delete","convertDate","myDate","start","Date","getTime","current","now","result","since","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","render","map","comment","i","isProfile"],"sources":["C:/Users/Fd-Formation/Desktop/Groupomania/front/src/components/Comments/Comments.js"],"sourcesContent":["import React from \"react\";\nimport axios from \"axios\";\n// Import component\nimport App from \"../App\";\nimport Comment from \"./Comment\";\nimport Avatar from \"../Avatar/Avatar\";\n// Import style\nimport \"./Comments.css\";\n\nexport default class Comments extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            // DATAS\n            userLogged: props.userLogged,\n            articleId: props.articleId,\n            comments: props.comments,\n            valueComment: '',\n            fileUpload: null,\n            // OPTIONS\n            isClicked: false,\n            isValid: true,\n            isLoading: false\n        }\n        // Request Url\n        this.commentUrl = 'http://localhost:8080/api/comments';\n        // OnClick\n        this.OnSubmitComment = this.OnSubmitComment.bind(this);\n        this.OnChange = this.OnChange.bind(this);\n        this.onDeleteClick = this.onDeleteClick.bind(this);\n        this.onOptionsClick = this.onOptionsClick.bind(this);\n    }\n\n    // Gestion de l'envoi.\n    OnSubmitComment(event) {\n        const { userLogged, articleId, valueComment, fileUpload } = this.state;\n        // Object contain value forms\n        const formData = new FormData();\n        formData.append(\"userId\", userLogged.id);\n        formData.append(\"comment\", valueComment);\n        formData.append(\"image\", fileUpload);\n        formData.append(\"articleId\", articleId);\n\n        event.preventDefault();\n        // Post request.\n        axios.post(this.commentUrl, formData, {\n            headers: {\n                Authorization: \"Bearer \" + sessionStorage.getItem(\"token\")\n            }\n        }).then(() => { App.ReloadApp(); })\n            .catch(error => {\n                console.error('Error Add Comment!');\n                console.warn(error);\n            });\n    }\n\n    // Gestion des events.\n    OnChange(event) {\n        const myState = event.target.name;\n        switch (myState) {\n            case 'comment':\n                if (event.target.value.length) {\n                    event.target.className = \"valid\";\n                    this.setState({ isValid: false });\n                }\n                else {\n                    event.target.className = \"\";\n                    this.setState({ isValid: true });\n                }\n                this.setState({ valueComment: event.target.value });\n                break;\n            case 'image':\n                this.setState({ fileUpload: event.target.files[0] });\n                break;\n            default:\n                console.error('Nothing here!');\n                break;\n        }\n    }\n\n    // Suppression d'un commentaire.\n    async onDeleteClick(event) {\n        const commentId = event.target.value;\n        if (window.confirm('Êtes vous sûre ?')) {\n            // Delete request.\n            await axios.delete(this.commentUrl + '/' + commentId, {\n                headers: {\n                    Authorization: \"Bearer \" + sessionStorage.getItem(\"token\")\n                }\n            }).then(() => App.ReloadApp());\n        }\n    }\n\n    // Afficher/Cacher les options.\n    onOptionsClick() {\n        const { isClicked } = this.state;\n        switch (isClicked) {\n            // Hide Options.\n            default:\n            case true:\n                this.setState({ isClicked: false });\n                break;\n            // Show Options.\n            case false:\n                this.setState({ isClicked: true });\n                break;\n        }\n    }\n\n    // Convertisseur de date.\n    convertDate(myDate) {\n        const start = new Date(myDate).getTime();\n        const current = Date.now();\n        const result = new Date(current - start);\n        let since = new Date(result);\n        if (since.getFullYear() <= 1970)\n            if (since.getMonth() + 1 <= 1)\n                if (since.getDate() <= 1)\n                    if (since.getHours() <= 1)\n                        if (since.getMinutes() < 1)\n                            since = new Date(result).getSeconds() + 'sec.';\n                        else since = since.getMinutes() + 'min.';\n                    else since = since.getHours() + 'h.';\n                else since = since.getDate() + 'j.';\n            else since = since.getMonth() + 1 + 'm.';\n        else since = since.getFullYear() + 'y.';\n\n        return `${since}`;\n    }\n\n    render() {\n        const { userLogged, comments } = this.state;\n        const { isValid, valueComment } = this.state\n        return (<>\n            {comments ? comments.map((comment, i) => (<>\n                <Comment key={'comment-' + comment.id} userLogged={userLogged} comment={comment} onDeleteClick={this.onDeleteClick} />\n            </>)) : (<></>)}\n\n            <form className=\"addComment\" onSubmit={this.OnSubmitComment} disabled={isValid}>\n                <Avatar key={'avatar-' + userLogged.id} dataUser={{ ...userLogged, isProfile: false }} />\n                <label htmlFor=\"comment\">comment</label>\n                <input id=\"comment\" type='text' name=\"comment\" placeholder='Ecrivez un commentaire...'\n                    value={valueComment} onChange={this.OnChange} />\n                <button aria-label=\"sendComment\" disabled={isValid}>\n                    <i className=\"fa-solid fa-paper-plane\" alt=\"sendComment\"></i>\n                </button>\n                <input type='hidden' name=\"userId\" value={userLogged.id} />\n            </form>\n        </>)\n    }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}