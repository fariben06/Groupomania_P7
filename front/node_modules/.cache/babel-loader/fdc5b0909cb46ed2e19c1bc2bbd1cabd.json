{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Fd-Formation\\\\Desktop\\\\Groupomania\\\\front\\\\src\\\\components\\\\App.js\";\nimport React from \"react\"; // Importer React pour utiliser les fonctionnalités de React\n\nimport axios from \"axios\"; // Importer axios pour utiliser les fonctions de axios pour les requêtes HTTP\n\nimport jwt_decode from \"jwt-decode\"; // Importer jwt_decode pour utiliser les fonctions de jwt_decode pour décodé les tokens\n\nimport Header from \"./Header/Header\"; // Importer Header pour utiliser les fonctions de Header pour le header de la page web\n\nimport Log from \"./Log/Log\"; // Importer Log pour utiliser les fonctions de Log pour le formulaire de connexion de la page web\n\nimport Home from \"./Home/Home\"; // Importer Home pour utiliser les fonctions de Home pour la page d'accueil de la page web\n\nimport Loader from \"./Loader/Loader\"; // Importer Loader pour utiliser les fonctions de Loader pour le loader de la page web\n// Créer une classe pour la page web \n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default class App extends React.Component {\n  constructor(props) {\n    // Constructeur de la classe App\n    super(props); // Appel du constructeur de la classe parente (React.Component)\n\n    this.state = {\n      // Définition du state de la classe App\n      isLoading: false,\n      // Définition de la variable isLoading pour le loader de la page web\n      articles: null,\n      // Définition de la variable articles pour les articles de la page web\n      isLogged: false,\n      // Définition de la variable isLogged pour la connexion de l'utilisateur de la page web\n      userLogged: props.dataUser,\n      // Définition de la variable userLogged pour les informations de l'utilisateur connecté\n      curPage: props.curPage,\n      // Définition de la variable curPage pour la page courante de la page web\n      error: '' // Définition de la variable error pour les erreurs de la page web (si il y en a)\n\n    };\n    this.userUrl = 'http://localhost:8080/api/user'; // Définition de l'url de l'API pour les utilisateurs\n\n    this.articlesUrl = 'http://localhost:8080/api/articles'; // Définition de l'url de l'API pour les articles\n\n    this.token = sessionStorage.getItem('token'); // Récupération du jeton dans le sessionStorage de la page web \n\n    console.warn('Entrez l\\'application');\n  } // Fonction qui s'exécute lorsque le composant est monté dans le DOM de la page web \n\n\n  componentDidMount() {\n    // Récupération des articles lorsque le composant est monté dans le DOM de la page web\n    const {\n      articles,\n      curPage\n    } = this.state; // Si la page courante est Home ou Login, on charge les articles  sinon on ne charge pas les articles\n\n    if (!articles || curPage === 'Home') this.getArticles();\n  } // Récupération des articles.\n\n\n  getArticles() {\n    this.setState({\n      isLoading: false\n    });\n    const {\n      isLogged,\n      userLogged\n    } = this.state;\n    console.log('[INFO] Chargement des articles...');\n    axios.get(this.articlesUrl).then(res => {\n      if (res.status === 204) this.setState({\n        articles: 0\n      });else this.setState({\n        articles: res.data.articles\n      });\n      console.warn('[SUCCESS] Articles chargés !');\n      if (!isLogged || !userLogged) this.checkLog();\n    }).catch(err => {\n      console.error('[ERROR] Erreur de chargement des articles!');\n      console.log(err);\n      this.setState({\n        isLoading: false,\n        error: 'Une erreur est survenue! Réessayer plus tard.'\n      });\n    });\n  } // Vérification du jeton +\n  // Récupération des informations de l'utilisateur.\n\n\n  checkLog() {\n    const {\n      userLogged\n    } = this.state;\n    console.log('[INFO] Vérification du jeton...');\n\n    if (this.token) {\n      console.warn('[SUCCESS] Jeton trouvé !');\n      console.log('[INFO] Vérification des informations utilisateur...');\n\n      if (!userLogged) {\n        console.warn('[ERROR] Infos utilisateur introuvables !'); // Checking here the token with jwt\n\n        const decodedToken = jwt_decode(this.token, 'RANDOM_TOKEN_SECRET');\n\n        if (decodedToken && decodedToken.userId) {\n          console.log('[INFO] Obtenir des informations sur l\\'utilisateur avec un jeton...');\n          const getUserUrl = this.userUrl + '?id=' + decodedToken.userId;\n          axios.get(getUserUrl).then(user => {\n            console.warn('[SUCCESS] Infos utilisateur avec jeton trouvé !');\n            this.setState({\n              curPage: 'Home',\n              userLogged: user.data.user,\n              isLogged: true,\n              isLoading: false\n            });\n          }).catch(error => {\n            console.warn('[ERROR] Infos utilisateur avec jeton introuvables !');\n            this.setState({\n              curPage: 'Login',\n              userLogged: null,\n              isLogged: false,\n              isLoading: false\n            });\n          });\n        } else this.setState({\n          curPage: 'Login',\n          isLogged: false,\n          isLoading: false\n        });\n      } else {\n        console.warn('[SUCCESS] Infos utilisateur trouvées !');\n        this.setState({\n          curPage: 'Home',\n          isLogged: true,\n          isLoading: false\n        });\n      }\n    } else {\n      console.warn('[INFO] Jeton introuvable !');\n      this.setState({\n        curPage: 'Login',\n        userLogged: null,\n        isLogged: false,\n        isLoading: false\n      });\n    }\n  } // Mise en page des composants.\n\n\n  setComponent() {\n    const {\n      curPage,\n      articles,\n      userLogged\n    } = this.state;\n\n    switch (curPage) {\n      case 'Login':\n        return /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: /*#__PURE__*/_jsxDEV(Log, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 98,\n            columnNumber: 19\n          }, this)\n        }, void 0, false);\n\n      case 'Home':\n        return /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: /*#__PURE__*/_jsxDEV(Home, {\n            articles: articles,\n            userLogged: userLogged\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 100,\n            columnNumber: 19\n          }, this)\n        }, void 0, false);\n\n      default:\n        break;\n    }\n  } // Rechargement de l'API.\n\n\n  static ReloadApp() {\n    console.log('Reloading App!');\n    window.location.reload(false);\n  }\n\n  render() {\n    const {\n      error,\n      isLoading\n    } = this.state;\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: !isLoading ? /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n          children: [error || error !== '' ? /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"error\",\n            children: error\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 118,\n            columnNumber: 36\n          }, this) : null, this.setComponent()]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true) : /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 14\n      }, this)\n    }, void 0, false);\n  }\n\n}","map":{"version":3,"names":["React","axios","jwt_decode","Header","Log","Home","Loader","App","Component","constructor","props","state","isLoading","articles","isLogged","userLogged","dataUser","curPage","error","userUrl","articlesUrl","token","sessionStorage","getItem","console","warn","componentDidMount","getArticles","setState","log","get","then","res","status","data","checkLog","catch","err","decodedToken","userId","getUserUrl","user","setComponent","ReloadApp","window","location","reload","render"],"sources":["C:/Users/Fd-Formation/Desktop/Groupomania/front/src/components/App.js"],"sourcesContent":["import React from \"react\"; // Importer React pour utiliser les fonctionnalités de React\nimport axios from \"axios\"; // Importer axios pour utiliser les fonctions de axios pour les requêtes HTTP\nimport jwt_decode from \"jwt-decode\"; // Importer jwt_decode pour utiliser les fonctions de jwt_decode pour décodé les tokens\nimport Header from \"./Header/Header\"; // Importer Header pour utiliser les fonctions de Header pour le header de la page web\nimport Log from \"./Log/Log\"; // Importer Log pour utiliser les fonctions de Log pour le formulaire de connexion de la page web\nimport Home from \"./Home/Home\"; // Importer Home pour utiliser les fonctions de Home pour la page d'accueil de la page web\nimport Loader from \"./Loader/Loader\"; // Importer Loader pour utiliser les fonctions de Loader pour le loader de la page web\n\n// Créer une classe pour la page web \nexport default class App extends React.Component {\n  constructor(props) { // Constructeur de la classe App\n    super(props); // Appel du constructeur de la classe parente (React.Component)\n    this.state = { // Définition du state de la classe App\n      isLoading: false, // Définition de la variable isLoading pour le loader de la page web\n      articles: null, // Définition de la variable articles pour les articles de la page web\n      isLogged: false, // Définition de la variable isLogged pour la connexion de l'utilisateur de la page web\n      userLogged: props.dataUser, // Définition de la variable userLogged pour les informations de l'utilisateur connecté\n      curPage: props.curPage, // Définition de la variable curPage pour la page courante de la page web\n      error: '' // Définition de la variable error pour les erreurs de la page web (si il y en a)\n    }\n    this.userUrl = 'http://localhost:8080/api/user'; // Définition de l'url de l'API pour les utilisateurs\n    this.articlesUrl = 'http://localhost:8080/api/articles'; // Définition de l'url de l'API pour les articles\n\n    this.token = sessionStorage.getItem('token'); // Récupération du jeton dans le sessionStorage de la page web \n\n    console.warn('Entrez l\\'application');\n  }\n\n  // Fonction qui s'exécute lorsque le composant est monté dans le DOM de la page web \n  componentDidMount() {\n    // Récupération des articles lorsque le composant est monté dans le DOM de la page web\n    const { articles, curPage } = this.state;\n    // Si la page courante est Home ou Login, on charge les articles  sinon on ne charge pas les articles\n    if (!articles || curPage === 'Home') this.getArticles();\n  }\n\n  // Récupération des articles.\n  getArticles() {\n    this.setState({ isLoading: false });\n    const { isLogged, userLogged } = this.state;\n    console.log('[INFO] Chargement des articles...');\n    axios.get(this.articlesUrl).then((res) => {\n      if (res.status === 204) this.setState({ articles: 0 });\n      else this.setState({ articles: res.data.articles });\n      console.warn('[SUCCESS] Articles chargés !');\n      if (!isLogged || !userLogged) this.checkLog();\n    })\n      .catch((err) => {\n        console.error('[ERROR] Erreur de chargement des articles!');\n        console.log(err);\n        this.setState({ isLoading: false, error: 'Une erreur est survenue! Réessayer plus tard.' });\n      });\n  }\n\n  // Vérification du jeton +\n  // Récupération des informations de l'utilisateur.\n  checkLog() {\n    const { userLogged } = this.state;\n    console.log('[INFO] Vérification du jeton...');\n    if (this.token) {\n      console.warn('[SUCCESS] Jeton trouvé !');\n      console.log('[INFO] Vérification des informations utilisateur...');\n      if (!userLogged) {\n        console.warn('[ERROR] Infos utilisateur introuvables !');\n        // Checking here the token with jwt\n        const decodedToken = jwt_decode(this.token, 'RANDOM_TOKEN_SECRET');\n        if (decodedToken && decodedToken.userId) {\n          console.log('[INFO] Obtenir des informations sur l\\'utilisateur avec un jeton...');\n          const getUserUrl = this.userUrl + '?id=' + decodedToken.userId;\n          axios.get(getUserUrl).then((user) => {\n            console.warn('[SUCCESS] Infos utilisateur avec jeton trouvé !');\n            this.setState({ curPage: 'Home', userLogged: user.data.user, isLogged: true, isLoading: false });\n          })\n            .catch((error) => {\n              console.warn('[ERROR] Infos utilisateur avec jeton introuvables !');\n              this.setState({ curPage: 'Login', userLogged: null, isLogged: false, isLoading: false });\n            });\n        }\n        else\n          this.setState({ curPage: 'Login', isLogged: false, isLoading: false });\n      }\n      else {\n        console.warn('[SUCCESS] Infos utilisateur trouvées !');\n        this.setState({ curPage: 'Home', isLogged: true, isLoading: false });\n      }\n    }\n    else {\n      console.warn('[INFO] Jeton introuvable !');\n      this.setState({ curPage: 'Login', userLogged: null, isLogged: false, isLoading: false });\n    }\n  }\n\n  // Mise en page des composants.\n  setComponent() {\n    const { curPage, articles, userLogged } = this.state;\n    switch (curPage) {\n      case 'Login':\n        return (<><Log /></>);\n      case 'Home':\n        return (<><Home articles={articles} userLogged={userLogged} /></>);\n      default:\n        break;\n    }\n  }\n\n  // Rechargement de l'API.\n  static ReloadApp() {\n    console.log('Reloading App!');\n    window.location.reload(false);\n  }\n\n  render() {\n    const { error, isLoading } = this.state;\n    return (<>\n      {!isLoading ? (<>\n        <Header />\n        <main>\n          {error || error !== '' ? <p className=\"error\">{error}</p> : null}\n          {this.setComponent()}\n        </main>\n      </>) : <Loader />}\n    </>)\n  }\n}\n"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB,C,CAA2B;;AAC3B,OAAOC,KAAP,MAAkB,OAAlB,C,CAA2B;;AAC3B,OAAOC,UAAP,MAAuB,YAAvB,C,CAAqC;;AACrC,OAAOC,MAAP,MAAmB,iBAAnB,C,CAAsC;;AACtC,OAAOC,GAAP,MAAgB,WAAhB,C,CAA6B;;AAC7B,OAAOC,IAAP,MAAiB,aAAjB,C,CAAgC;;AAChC,OAAOC,MAAP,MAAmB,iBAAnB,C,CAAsC;AAEtC;;;;AACA,eAAe,MAAMC,GAAN,SAAkBP,KAAK,CAACQ,SAAxB,CAAkC;EAC/CC,WAAW,CAACC,KAAD,EAAQ;IAAE;IACnB,MAAMA,KAAN,EADiB,CACH;;IACd,KAAKC,KAAL,GAAa;MAAE;MACbC,SAAS,EAAE,KADA;MACO;MAClBC,QAAQ,EAAE,IAFC;MAEK;MAChBC,QAAQ,EAAE,KAHC;MAGM;MACjBC,UAAU,EAAEL,KAAK,CAACM,QAJP;MAIiB;MAC5BC,OAAO,EAAEP,KAAK,CAACO,OALJ;MAKa;MACxBC,KAAK,EAAE,EANI,CAMD;;IANC,CAAb;IAQA,KAAKC,OAAL,GAAe,gCAAf,CAViB,CAUgC;;IACjD,KAAKC,WAAL,GAAmB,oCAAnB,CAXiB,CAWwC;;IAEzD,KAAKC,KAAL,GAAaC,cAAc,CAACC,OAAf,CAAuB,OAAvB,CAAb,CAbiB,CAa6B;;IAE9CC,OAAO,CAACC,IAAR,CAAa,uBAAb;EACD,CAjB8C,CAmB/C;;;EACAC,iBAAiB,GAAG;IAClB;IACA,MAAM;MAAEb,QAAF;MAAYI;IAAZ,IAAwB,KAAKN,KAAnC,CAFkB,CAGlB;;IACA,IAAI,CAACE,QAAD,IAAaI,OAAO,KAAK,MAA7B,EAAqC,KAAKU,WAAL;EACtC,CAzB8C,CA2B/C;;;EACAA,WAAW,GAAG;IACZ,KAAKC,QAAL,CAAc;MAAEhB,SAAS,EAAE;IAAb,CAAd;IACA,MAAM;MAAEE,QAAF;MAAYC;IAAZ,IAA2B,KAAKJ,KAAtC;IACAa,OAAO,CAACK,GAAR,CAAY,mCAAZ;IACA5B,KAAK,CAAC6B,GAAN,CAAU,KAAKV,WAAf,EAA4BW,IAA5B,CAAkCC,GAAD,IAAS;MACxC,IAAIA,GAAG,CAACC,MAAJ,KAAe,GAAnB,EAAwB,KAAKL,QAAL,CAAc;QAAEf,QAAQ,EAAE;MAAZ,CAAd,EAAxB,KACK,KAAKe,QAAL,CAAc;QAAEf,QAAQ,EAAEmB,GAAG,CAACE,IAAJ,CAASrB;MAArB,CAAd;MACLW,OAAO,CAACC,IAAR,CAAa,8BAAb;MACA,IAAI,CAACX,QAAD,IAAa,CAACC,UAAlB,EAA8B,KAAKoB,QAAL;IAC/B,CALD,EAMGC,KANH,CAMUC,GAAD,IAAS;MACdb,OAAO,CAACN,KAAR,CAAc,4CAAd;MACAM,OAAO,CAACK,GAAR,CAAYQ,GAAZ;MACA,KAAKT,QAAL,CAAc;QAAEhB,SAAS,EAAE,KAAb;QAAoBM,KAAK,EAAE;MAA3B,CAAd;IACD,CAVH;EAWD,CA3C8C,CA6C/C;EACA;;;EACAiB,QAAQ,GAAG;IACT,MAAM;MAAEpB;IAAF,IAAiB,KAAKJ,KAA5B;IACAa,OAAO,CAACK,GAAR,CAAY,iCAAZ;;IACA,IAAI,KAAKR,KAAT,EAAgB;MACdG,OAAO,CAACC,IAAR,CAAa,0BAAb;MACAD,OAAO,CAACK,GAAR,CAAY,qDAAZ;;MACA,IAAI,CAACd,UAAL,EAAiB;QACfS,OAAO,CAACC,IAAR,CAAa,0CAAb,EADe,CAEf;;QACA,MAAMa,YAAY,GAAGpC,UAAU,CAAC,KAAKmB,KAAN,EAAa,qBAAb,CAA/B;;QACA,IAAIiB,YAAY,IAAIA,YAAY,CAACC,MAAjC,EAAyC;UACvCf,OAAO,CAACK,GAAR,CAAY,qEAAZ;UACA,MAAMW,UAAU,GAAG,KAAKrB,OAAL,GAAe,MAAf,GAAwBmB,YAAY,CAACC,MAAxD;UACAtC,KAAK,CAAC6B,GAAN,CAAUU,UAAV,EAAsBT,IAAtB,CAA4BU,IAAD,IAAU;YACnCjB,OAAO,CAACC,IAAR,CAAa,iDAAb;YACA,KAAKG,QAAL,CAAc;cAAEX,OAAO,EAAE,MAAX;cAAmBF,UAAU,EAAE0B,IAAI,CAACP,IAAL,CAAUO,IAAzC;cAA+C3B,QAAQ,EAAE,IAAzD;cAA+DF,SAAS,EAAE;YAA1E,CAAd;UACD,CAHD,EAIGwB,KAJH,CAIUlB,KAAD,IAAW;YAChBM,OAAO,CAACC,IAAR,CAAa,qDAAb;YACA,KAAKG,QAAL,CAAc;cAAEX,OAAO,EAAE,OAAX;cAAoBF,UAAU,EAAE,IAAhC;cAAsCD,QAAQ,EAAE,KAAhD;cAAuDF,SAAS,EAAE;YAAlE,CAAd;UACD,CAPH;QAQD,CAXD,MAaE,KAAKgB,QAAL,CAAc;UAAEX,OAAO,EAAE,OAAX;UAAoBH,QAAQ,EAAE,KAA9B;UAAqCF,SAAS,EAAE;QAAhD,CAAd;MACH,CAlBD,MAmBK;QACHY,OAAO,CAACC,IAAR,CAAa,wCAAb;QACA,KAAKG,QAAL,CAAc;UAAEX,OAAO,EAAE,MAAX;UAAmBH,QAAQ,EAAE,IAA7B;UAAmCF,SAAS,EAAE;QAA9C,CAAd;MACD;IACF,CA1BD,MA2BK;MACHY,OAAO,CAACC,IAAR,CAAa,4BAAb;MACA,KAAKG,QAAL,CAAc;QAAEX,OAAO,EAAE,OAAX;QAAoBF,UAAU,EAAE,IAAhC;QAAsCD,QAAQ,EAAE,KAAhD;QAAuDF,SAAS,EAAE;MAAlE,CAAd;IACD;EACF,CAjF8C,CAmF/C;;;EACA8B,YAAY,GAAG;IACb,MAAM;MAAEzB,OAAF;MAAWJ,QAAX;MAAqBE;IAArB,IAAoC,KAAKJ,KAA/C;;IACA,QAAQM,OAAR;MACE,KAAK,OAAL;QACE,oBAAQ;UAAA,uBAAE,QAAC,GAAD;YAAA;YAAA;YAAA;UAAA;QAAF,iBAAR;;MACF,KAAK,MAAL;QACE,oBAAQ;UAAA,uBAAE,QAAC,IAAD;YAAM,QAAQ,EAAEJ,QAAhB;YAA0B,UAAU,EAAEE;UAAtC;YAAA;YAAA;YAAA;UAAA;QAAF,iBAAR;;MACF;QACE;IANJ;EAQD,CA9F8C,CAgG/C;;;EACgB,OAAT4B,SAAS,GAAG;IACjBnB,OAAO,CAACK,GAAR,CAAY,gBAAZ;IACAe,MAAM,CAACC,QAAP,CAAgBC,MAAhB,CAAuB,KAAvB;EACD;;EAEDC,MAAM,GAAG;IACP,MAAM;MAAE7B,KAAF;MAASN;IAAT,IAAuB,KAAKD,KAAlC;IACA,oBAAQ;MAAA,UACL,CAACC,SAAD,gBAAc;QAAA,wBACb,QAAC,MAAD;UAAA;UAAA;UAAA;QAAA,QADa,eAEb;UAAA,WACGM,KAAK,IAAIA,KAAK,KAAK,EAAnB,gBAAwB;YAAG,SAAS,EAAC,OAAb;YAAA,UAAsBA;UAAtB;YAAA;YAAA;YAAA;UAAA,QAAxB,GAA2D,IAD9D,EAEG,KAAKwB,YAAL,EAFH;QAAA;UAAA;UAAA;UAAA;QAAA,QAFa;MAAA,gBAAd,gBAMM,QAAC,MAAD;QAAA;QAAA;QAAA;MAAA;IAPD,iBAAR;EASD;;AAjH8C"},"metadata":{},"sourceType":"module"}